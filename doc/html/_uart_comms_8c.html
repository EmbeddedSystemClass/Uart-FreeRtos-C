<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>FreeRTOS-Uart: src/UartComms.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript">
$(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.7.4 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">FreeRTOS-Uart&#160;<span id="projectnumber">v1.0.0</span></div>
   <div id="projectbrief">A FreeRTOS task acting as a driver for a UART on an embedded system. Ported for a PSoC 5 microcontroller.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li id="searchli">
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('_uart_comms_8c.html','');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">src/UartComms.c File Reference</div>  </div>
</div>
<div class="contents">

<p>Used for receiving/sending comms messages across the dedicated UART.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;device.h&gt;</code><br/>
<code>#include &quot;FreeRTOS.h&quot;</code><br/>
<code>#include &quot;task.h&quot;</code><br/>
<code>#include &quot;queue.h&quot;</code><br/>
<code>#include &quot;semphr.h&quot;</code><br/>
<code>#include &quot;PublicDefinesAndTypeDefs.h&quot;</code><br/>
<code>#include &quot;Config.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="_uart_comms_8h_source.html">UartComms.h</a>&quot;</code><br/>
<code>#include &quot;UartDebug.h&quot;</code><br/>
</div><table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a91cd690eeb190bd4abd4ec6d5d39bf59"></a><!-- doxytag: member="UartComms.c::TX_QUEUE_SIZE" ref="a91cd690eeb190bd4abd4ec6d5d39bf59" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#a91cd690eeb190bd4abd4ec6d5d39bf59">TX_QUEUE_SIZE</a>&#160;&#160;&#160;(1)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue size is 1, messages are sent byte by byte across the queue. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0616225f8714515d1139d62323d2fb60"></a><!-- doxytag: member="UartComms.c::RX_QUEUE_SIZE" ref="a0616225f8714515d1139d62323d2fb60" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#a0616225f8714515d1139d62323d2fb60">RX_QUEUE_SIZE</a>&#160;&#160;&#160;(1)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Queue size is 1, messages are sent byte by byte across the queue. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#a02223032694bd668b929b5230ffce42b">TX_QUEUE_MAX_WAIT_TIME_MS</a>&#160;&#160;&#160;(1000)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#a7e01dd4cae91de3576434a0732d84f85">TX_SEMAPHORE_MAX_WAIT_TIME_MS</a>&#160;&#160;&#160;(1000)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa42523b55b5f8118cabe6455badbfe36"></a><!-- doxytag: member="UartComms.c::TIME_TO_WAIT_FOR_ANOTHER_CHAR_BEFORE_SLEEPING_MS" ref="aa42523b55b5f8118cabe6455badbfe36" args="" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#aa42523b55b5f8118cabe6455badbfe36">TIME_TO_WAIT_FOR_ANOTHER_CHAR_BEFORE_SLEEPING_MS</a>&#160;&#160;&#160;(5)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Time to wait for another char to arrive on tx queue before the UART module is slept. <br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#aac2d044397bd09fc703457a66a9913ab">vUartComms_TxTask</a> (void *pvParameters)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">DEBUG UART TX task.  <a href="#aac2d044397bd09fc703457a66a9913ab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a11737122d2b56c371cc807261a941b49"></a><!-- doxytag: member="UartComms.c::CY_ISR_PROTO" ref="a11737122d2b56c371cc807261a941b49" args="(UartComms_UartRxIsr)" -->
&#160;</td><td class="memItemRight" valign="bottom"><b>CY_ISR_PROTO</b> (UartComms_UartRxIsr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#a9978d3ae647958bc088d053334bb8a2f">UartComms_Start</a> (uint32 txTaskStackSize, uint8 txTaskPriority)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Start-up function. Call from main() before starting scheduler.  <a href="#a9978d3ae647958bc088d053334bb8a2f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">xTaskHandle&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#a58f0052a29f78d68de5d5e93a1f492ef">UartComms_ReturnTxTaskHandle</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the handle for the TX task.  <a href="#a58f0052a29f78d68de5d5e93a1f492ef"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#a1fb7ee2882d9b29764cfe9dcf3818567">UartComms_PutString</a> (char *string)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Puts null-terminated string onto tx queue.  <a href="#a1fb7ee2882d9b29764cfe9dcf3818567"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#a00f467822db4ff6e8faba02d9f145f15">UartComms_GetChar</a> (char *singleChar)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afd08bdb83a3139ce4c3b5288e47566e0"></a><!-- doxytag: member="UartComms.c::UartComms_IsAsleep" ref="afd08bdb83a3139ce4c3b5288e47566e0" args="(void)" -->
bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#afd08bdb83a3139ce4c3b5288e47566e0">UartComms_IsAsleep</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns sleep state of the UART. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#a45f5b545928edfa71560f74185cdbd6e">UartComms_SleepLock</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to prevent the DEBUG UART from sleeping.  <a href="#a45f5b545928edfa71560f74185cdbd6e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#a8ffe018117be46e5b6a9e604d0c4903e">UartComms_SleepUnlock</a> (void)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to allow the DEBUG UART to sleep.  <a href="#a8ffe018117be46e5b6a9e604d0c4903e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#a651f051435eda14487d70210534122cb">CY_ISR</a> (UartComms_UartRxIsr)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">ISR called when UART rx buffer has new character.  <a href="#a651f051435eda14487d70210534122cb"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac334e3fb9ec3ed069473a05ad526452a"></a><!-- doxytag: member="UartComms.c::_txTaskHandle" ref="ac334e3fb9ec3ed069473a05ad526452a" args="" -->
static xTaskHandle&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#ac334e3fb9ec3ed069473a05ad526452a">_txTaskHandle</a> = 0</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Handle for the TX task. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a11d8c6f4557c3e8999498c54fe60b07e"></a><!-- doxytag: member="UartComms.c::_xTxMutexSemaphore" ref="a11d8c6f4557c3e8999498c54fe60b07e" args="" -->
static xSemaphoreHandle&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#a11d8c6f4557c3e8999498c54fe60b07e">_xTxMutexSemaphore</a> = 0</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Mutex semaphore for allowing only one task to write to the tx buffer at once. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a525defadfc1ed6d5fd03fc18391ed7b9"></a><!-- doxytag: member="UartComms.c::_uartDebugSleepLockCount" ref="a525defadfc1ed6d5fd03fc18391ed7b9" args="" -->
static uint8&#160;</td><td class="memItemRight" valign="bottom"><b>_uartDebugSleepLockCount</b> = 0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static xQueueHandle&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#a32db6c2c27f5578c5c52ec2490d41280">_xRxQueue</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Used by the functions <a class="el" href="_uart_comms_8c.html#a45f5b545928edfa71560f74185cdbd6e" title="Used to prevent the DEBUG UART from sleeping.">UartComms_SleepLock()</a> and <a class="el" href="_uart_comms_8c.html#a8ffe018117be46e5b6a9e604d0c4903e" title="Used to allow the DEBUG UART to sleep.">UartComms_SleepUnlock()</a> to keep track of how many time the uart has been locked from sleeping.  <a href="#a32db6c2c27f5578c5c52ec2490d41280"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a49b66363344549efb90d7d52c9b57458"></a><!-- doxytag: member="UartComms.c::_xTxQueue" ref="a49b66363344549efb90d7d52c9b57458" args="" -->
static xQueueHandle&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#a49b66363344549efb90d7d52c9b57458">_xTxQueue</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Tx queue. Place characters on here to send them to the DEBUG module. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa969b199756a943c8fa8dc46cfb2bb4b"></a><!-- doxytag: member="UartComms.c::_isAsleep" ref="aa969b199756a943c8fa8dc46cfb2bb4b" args="" -->
static bool_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_uart_comms_8c.html#aa969b199756a943c8fa8dc46cfb2bb4b">_isAsleep</a> = FALSE</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable is TRUE if uart is asleep, otherwise FALSE. <br/></td></tr>
<tr><td class="memItemLeft" ><a class="anchor" id="af2592a2de49e467cfbd5956cf2db6979"></a><!-- doxytag: member="UartComms.c::_uartCommsParameters" ref="af2592a2de49e467cfbd5956cf2db6979" args="" -->
struct {</td></tr>
<tr><td class="memItemLeft" >&#160;&#160;&#160;bool_t&#160;&#160;&#160;<b>allowUartSleep</b></td></tr>
<tr><td class="memItemLeft" valign="top">}&#160;</td><td class="memItemRight" valign="bottom"><b>_uartCommsParameters</b></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Used for receiving/sending comms messages across the dedicated UART. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Geoffrey Hunter (<a href="mailto:gbmhunter@gmail.com">gbmhunter@gmail.com</a>) </dd></dl>
<dl class="date"><dt><b>Date:</b></dt><dd>12/09/2012</dd></dl>
<p><b>Last Modified: </b> 27/09/2012 <br/>
 <b>Version: </b> v1.0.0 <br/>
 <b>Company: </b> CladLabs <br/>
 <b>Project: </b> Template Code <br/>
 <b>Computer Architecture: </b> ARM <br/>
 <b>Compiler: </b> GCC <br/>
 <b>uC Model: </b> PSoC5 <br/>
 <b>Operating System: </b> FreeRTOS v7.2.0 <br/>
 <b>Documentation Format: </b> Doxygen <br/>
</p>
<p>Used for comms uart communication in an RTOS environement. Uses queues to allow multiple calls to the uart at once. </p>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="a02223032694bd668b929b5230ffce42b"></a><!-- doxytag: member="UartComms.c::TX_QUEUE_MAX_WAIT_TIME_MS" ref="a02223032694bd668b929b5230ffce42b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TX_QUEUE_MAX_WAIT_TIME_MS&#160;&#160;&#160;(1000)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Max time (in ms) to wait for putting character onto tx queue before error occurs </p>

</div>
</div>
<a class="anchor" id="a7e01dd4cae91de3576434a0732d84f85"></a><!-- doxytag: member="UartComms.c::TX_SEMAPHORE_MAX_WAIT_TIME_MS" ref="a7e01dd4cae91de3576434a0732d84f85" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define TX_SEMAPHORE_MAX_WAIT_TIME_MS&#160;&#160;&#160;(1000)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Max time (in ms) to wait for another task to finish putting a string onto the tx queue Since only the DEBUG task is using this UART, the semaphore should never have to be waited on. </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a651f051435eda14487d70210534122cb"></a><!-- doxytag: member="UartComms.c::CY_ISR" ref="a651f051435eda14487d70210534122cb" args="(UartComms_UartRxIsr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CY_ISR </td>
          <td>(</td>
          <td class="paramtype">UartComms_UartRxIsr&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>ISR called when UART rx buffer has new character. </p>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>Get rid of this </dd></dl>
</p>

</div>
</div>
<a class="anchor" id="a00f467822db4ff6e8faba02d9f145f15"></a><!-- doxytag: member="UartComms.c::UartComms_GetChar" ref="a00f467822db4ff6e8faba02d9f145f15" args="(char *singleChar)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UartComms_GetChar </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>singleChar</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Blocks until character is received </p>
<dl class="note"><dt><b>Note:</b></dt><dd>Not-thread safe. </dd></dl>

</div>
</div>
<a class="anchor" id="a1fb7ee2882d9b29764cfe9dcf3818567"></a><!-- doxytag: member="UartComms.c::UartComms_PutString" ref="a1fb7ee2882d9b29764cfe9dcf3818567" args="(char *string)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool_t UartComms_PutString </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>string</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Puts null-terminated string onto tx queue. </p>
<p>This is a blocking function which will not return until the entire string has been put onto the queue. It will block if another task is currently putting stuff on the queue (and hence the semaphore taken), or the tx queue is full (hence the UART is busy). </p>
<dl class="note"><dt><b>Note:</b></dt><dd>Thread-safe </dd></dl>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Add error handling </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>Add error handling if queue fail </dd></dl>
</p>

</div>
</div>
<a class="anchor" id="a58f0052a29f78d68de5d5e93a1f492ef"></a><!-- doxytag: member="UartComms.c::UartComms_ReturnTxTaskHandle" ref="a58f0052a29f78d68de5d5e93a1f492ef" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">xTaskHandle UartComms_ReturnTxTaskHandle </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the handle for the TX task. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Handle of the TX task </dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>Thread-safe </dd></dl>

</div>
</div>
<a class="anchor" id="a45f5b545928edfa71560f74185cdbd6e"></a><!-- doxytag: member="UartComms.c::UartComms_SleepLock" ref="a45f5b545928edfa71560f74185cdbd6e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UartComms_SleepLock </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Used to prevent the DEBUG UART from sleeping. </p>
<p>Can be called from any task, up to 255 times. The UART will be prevented from sleeping until a similar number of <a class="el" href="_uart_comms_8c.html#a8ffe018117be46e5b6a9e604d0c4903e" title="Used to allow the DEBUG UART to sleep.">UartComms_SleepUnlock()</a> calls have been made. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>Thread-safe </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="_uart_comms_8c.html#a8ffe018117be46e5b6a9e604d0c4903e" title="Used to allow the DEBUG UART to sleep.">UartComms_SleepUnlock()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a8ffe018117be46e5b6a9e604d0c4903e"></a><!-- doxytag: member="UartComms.c::UartComms_SleepUnlock" ref="a8ffe018117be46e5b6a9e604d0c4903e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UartComms_SleepUnlock </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Used to allow the DEBUG UART to sleep. </p>
<p>Can be called from any task, up to 255 times. This function needs to be called as many times as UartComms_SleepLock was called before the UART will be allowed to sleep. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>Thread-safe </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="_uart_comms_8c.html#a45f5b545928edfa71560f74185cdbd6e" title="Used to prevent the DEBUG UART from sleeping.">UartComms_SleepLock()</a> </dd></dl>

</div>
</div>
<a class="anchor" id="a9978d3ae647958bc088d053334bb8a2f"></a><!-- doxytag: member="UartComms.c::UartComms_Start" ref="a9978d3ae647958bc088d053334bb8a2f" args="(uint32 txTaskStackSize, uint8 txTaskPriority)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UartComms_Start </td>
          <td>(</td>
          <td class="paramtype">uint32&#160;</td>
          <td class="paramname"><em>txTaskStackSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8&#160;</td>
          <td class="paramname"><em>txTaskPriority</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Start-up function. Call from main() before starting scheduler. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>Not thread-safe. Do not call from any task! </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd>main() </dd></dl>

</div>
</div>
<a class="anchor" id="aac2d044397bd09fc703457a66a9913ab"></a><!-- doxytag: member="UartComms.c::vUartComms_TxTask" ref="aac2d044397bd09fc703457a66a9913ab" args="(void *pvParameters)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void vUartComms_TxTask </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>pvParameters</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>DEBUG UART TX task. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">*pvParameters</td><td>Void pointer (not used) </td></tr>
  </table>
  </dd>
</dl>
<dl class="note"><dt><b>Note:</b></dt><dd>Not thread-safe. Do not call from any task, this function is a task that is called by the FreeRTOS kernel </dd></dl>

<p><p>&lt; Initial state</p>
<p>&lt; Idle state. UART could be asleep in this state</p>
<p>&lt; Sending state. UART is prevented from sleeping in this state until timeout</p>
<p>Holds received character from the #xUartCommsTxQueue</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>Implement this in a blocking fashion? </dd></dl>
</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a32db6c2c27f5578c5c52ec2490d41280"></a><!-- doxytag: member="UartComms.c::_xRxQueue" ref="a32db6c2c27f5578c5c52ec2490d41280" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">xQueueHandle <a class="el" href="_uart_comms_8c.html#a32db6c2c27f5578c5c52ec2490d41280">_xRxQueue</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Used by the functions <a class="el" href="_uart_comms_8c.html#a45f5b545928edfa71560f74185cdbd6e" title="Used to prevent the DEBUG UART from sleeping.">UartComms_SleepLock()</a> and <a class="el" href="_uart_comms_8c.html#a8ffe018117be46e5b6a9e604d0c4903e" title="Used to allow the DEBUG UART to sleep.">UartComms_SleepUnlock()</a> to keep track of how many time the uart has been locked from sleeping. </p>
<p>RX queue. Uart interrupt places characters on this queue as soon as they are received. </p>

</div>
</div>
</div>
</div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="_uart_comms_8c.html">UartComms.c</a>      </li>
      <li class="footer">Generated on Fri Sep 28 2012 16:58:43 for FreeRTOS-Uart by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>


</body>
</html>
